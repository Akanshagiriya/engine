{
    "index": "minds-metrics-*",
    "size": "0",
    "body": {
        "query": {
            "bool": {
                "must": [
                    {
                        "match_phrase": {
                            "action.keyword": {
                                "query": "active"
                            }
                        }
                    },
                    {
                        "range": {
                            "@timestamp": {
                                "from": 1548892800000,
                                "to": 1549583999000,
                                "format": "epoch_millis"
                            }
                        }
                    }
                ]
            }
        },
        "aggs": {
            "users": {
                "terms": {
                    "field": "user_guid.keyword",
                    "size": 5000,
                    "include": {
                        "partition": 0,
                        "num_partitions": 200
                    }
                },
                "aggs": {
                    "1548979200": {
                        "date_range": {
                            "field": "@timestamp",
                            "ranges": [
                                {
                                    "from": 1548979200000,
                                    "to": 1549065600000
                                }
                            ]
                        }
                    },
                    "count-1548979200": {
                        "sum_bucket": {
                            "buckets_path": "1548979200>_count"
                        }
                    },
                    "1549065600": {
                        "date_range": {
                            "field": "@timestamp",
                            "ranges": [
                                {
                                    "from": 1549065600000,
                                    "to": 1549152000000
                                }
                            ]
                        }
                    },
                    "count-1549065600": {
                        "sum_bucket": {
                            "buckets_path": "1549065600>_count"
                        }
                    },
                    "1549152000": {
                        "date_range": {
                            "field": "@timestamp",
                            "ranges": [
                                {
                                    "from": 1549152000000,
                                    "to": 1549238400000
                                }
                            ]
                        }
                    },
                    "count-1549152000": {
                        "sum_bucket": {
                            "buckets_path": "1549152000>_count"
                        }
                    },
                    "1549238400": {
                        "date_range": {
                            "field": "@timestamp",
                            "ranges": [
                                {
                                    "from": 1549238400000,
                                    "to": 1549324800000
                                }
                            ]
                        }
                    },
                    "count-1549238400": {
                        "sum_bucket": {
                            "buckets_path": "1549238400>_count"
                        }
                    },
                    "1549324800": {
                        "date_range": {
                            "field": "@timestamp",
                            "ranges": [
                                {
                                    "from": 1549324800000,
                                    "to": 1549411200000
                                }
                            ]
                        }
                    },
                    "count-1549324800": {
                        "sum_bucket": {
                            "buckets_path": "1549324800>_count"
                        }
                    },
                    "1549411200": {
                        "date_range": {
                            "field": "@timestamp",
                            "ranges": [
                                {
                                    "from": 1549411200000,
                                    "to": 1549497600000
                                }
                            ]
                        }
                    },
                    "count-1549411200": {
                        "sum_bucket": {
                            "buckets_path": "1549411200>_count"
                        }
                    },
                    "1549497600": {
                        "date_range": {
                            "field": "@timestamp",
                            "ranges": [
                                {
                                    "from": 1549497600000,
                                    "to": 1549584000000
                                }
                            ]
                        }
                    },
                    "count-1549497600": {
                        "sum_bucket": {
                            "buckets_path": "1549497600>_count"
                        }
                    }
                }
            }
        }
    }
}
